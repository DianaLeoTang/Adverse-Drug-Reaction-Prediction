## 📊 **数据来源**

### 主要数据源(三个)
1. **FAERS (FDA不良事件报告系统)**
   - 时间跨度: 2012-2023年
   - 最终数据量: 1,365,846个报告病例
   - 包含内容: 患者人口统计学信息(年龄、性别)和ADR信息

2. **DrugBank**
   - 提供药物的生物学特征
   - 包括4类蛋白质: 靶点、酶、载体、转运体
   - 共1,411个生物学特征

3. **PubChem**
   - 提供化学特征
   - 881个亚结构指纹特征
   - 17个分子描述符

### 最终数据集规模
- **946种药物**
- **30种常见且严重的ADR**(从FDA标签警告中选择)
- **特征总数**: 2,315个(881化学 + 17分子 + 1,411生物 + 6人口统计学)

---

## 🔬 **研究方法**

### 数据预处理(5步)
1. 使用RxNorm标准化药物名称
2. 移除人口统计学数据缺失的患者
3. 将年龄分为5组: <17岁、17-40岁、41-60岁、61-76岁、>76岁
4. 使用SIDER数据库验证药物-ADR配对
5. 数据去重

### 数据分割策略
- **非传统随机分割**: 在分子类别层面分割(防止数据泄漏)
- 使用K-means聚类创建25个分子簇
- 训练/测试集: **80/20分割**

---

## 🤖 **所用模型及参数**

### 1. **随机森林 (Random Forest, RF)**
**参数设置:**
- 决策树数量: **300棵树**
- 用途: 多标签分类 + 特征重要性提取

**优点:** 可解释性强,能提取特征重要性

### 2. **深度学习 (Deep Learning, DL)**
**网络架构:**
- **4层结构**: 输入层 + 2个隐藏层 + 输出层
- 输出层: **30个节点**(对应30种ADR)
- 激活函数: **Sigmoid**
- 损失函数: **交叉熵 (Cross-entropy)**

**优点:** 更高的预测性能

### 模型组合实验
共训练**15组模型** (2种算法 × 多种特征组合):
- Chemical + Molecular + Biological ± Demographic
- Molecular + Biological ± Demographic  
- Chemical + Molecular ± Demographic
- 各单一特征集 ± Demographic

---

## 📈 **实验结论**

### 核心发现

#### **1. 人口统计学特征的重要性**
- 仅添加**6个人口统计学特征**即可显著提升模型性能
- **DL模型AUC提升幅度**:
  - Chemical+Molecular+Biological: 0.682 → **0.700** (+1.8%)
  - Molecular+Biological: 0.670 → **0.691** (+2.1%)
  - Molecular only: 0.574 → **0.613** (+3.9%)
- 仅使用6个人口统计学特征,DL模型AUC达到**0.555**

#### **2. 精简模型的有效性**
**Top 20重要特征构成:**
- 5个人口统计学特征(所有年龄组 + 性别)
- 13个分子特征
- 2个生物特征

**精简模型性能:**
- RF模型: AUC = **0.611**, 仅比完整模型(0.681)低7%
- DL模型: AUC = **0.674**, 仅比完整模型(0.700)低2.6%

**结论**: 使用仅20个特征的精简模型可达到与2,315特征完整模型相当的预测性能

#### **3. 模型性能对比**
- **15个模型中有13个DL模型**的AUC ≥ 对应RF模型
- **14个DL模型**的MAP ≥ 对应RF模型
- DL模型整体优于RF模型

---

## 🏆 **最重要特征(Top 5)**

### 人口统计学特征(所有进入Top 5)
1-5. 五个年龄组 + 性别

### 分子特征(最重要的3个)
1. **XLogP3** (脂溶性参数): 影响药物吸收、分布、代谢
2. **拓扑极性表面积**: 影响肠道吸收和血脑屏障穿透
3. **重原子计数/分子量/复杂度**: 与ADR发生率相关

### 生物特征(最重要的2个)
1. **ABCB1转运体**: ABC转运体家族成员,影响药物分布
2. **ALB (白蛋白)**: 血浆蛋白,药物载体

---

## 📊 **评估指标**

- **AUC** (ROC曲线下面积)
- **MAP** (平均精确度均值)

---

## 💡 **研究创新点**

1. **首次结合**人口统计学数据和非临床数据预测ADR
2. 证明了仅需少量人口统计学特征即可显著提升模型性能
3. 开发了实用的**精简模型**(20特征),性能接近完整模型(2,315特征)
4. 分析了**个体特征重要性**,而非仅关注特征集整体

这项研究为临床工作者和研究人员提供了实用的ADR预测工具,特别强调了年龄和性别等人口统计学因素在药物安全性评估中的关键作用。